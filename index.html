<!DOCTYPE html>
<html>

<head>
    <title>My Practical Projects</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <h1>Software Testing Practicals</h1>
        <nav>
            <ul>
                <li><a href="#practical1">Practical 1</a></li>
                <li><a href="#practical2">Practical 2</a></li>
                <li><a href="#practical3">Practical 3</a></li>
                <li><a href="#practical4">Practical 4</a></li>
                <li><a href="#practical5">Practical 5</a></li>
                <li><a href="#practical6">Practical 6</a></li>
                 <li><a href="#practical7">Practical 7</a></li>
                 <li><a href="#practical8">Practical 8</a></li>
                 <li><a href="#practical9">Practical 9</a></li>
                 <li><a href="#practical10">Practical 10</a></li>
                 <li><a href="#practical11">Practical 11</a></li>
            </ul>
        </nav>
        <div class="project" id="prectical1">
            <h2>Practical 1: Downloading & Installing Selenium Webdriver</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
1. Python Setup (If you don't have it already)
   - Download: Head over to https://www.python.org/downloads/ and grab the appropriate installer for your operating system (Windows, macOS, or Linux).
   - Installation: Run the installer. Be sure to check the box that says "Add Python to PATH" during the installation process. This lets you easily use Python from your command line or terminal.

2. Selenium WebDriver Installation
   - Open Your Terminal/Command Prompt:
     - Windows: Search for "cmd" in your start menu.
     - macOS: Open "Terminal" using Spotlight search.
     - Linux: You're likely familiar with your terminal.
   - Use pip: Type the following command and press Enter:
     ```bash
     pip install selenium
     ```
     This fetches Selenium and sets it up within your Python environment.

3. Browser Driver Setup
   - Choose Your Browser: Decide which browser you'll primarily use for testing (Chrome, Firefox, Edge, etc.).
   - Download the Driver:
     - Chrome: https://chromedriver.chromium.org/downloads
     - Firefox (GeckoDriver): https://github.com/mozilla/geckodriver/releases
     - Edge: https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/
     - Important: Make sure the driver version matches your browser version for the best compatibility.
   - Placement:
     - Option 1 (Recommended): Place the downloaded driver executable (e.g., chromedriver.exe) in a directory that's already in your system's PATH environment variable. This way, Selenium can find it automatically.
     - Option 2: Place the driver in a specific folder, and then provide the path to that folder in your Python code when you initialize your WebDriver.

You're Ready!
        </code></pre>
            </div>
        </div>

        <div class="project" id="practical2">
            <h2>Practical 2:Launch any E-commerce website and print message on a screen using Selenium Webdriver.</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.alert import Alert
import time

# Start a WebDriver session (assuming Chrome driver here)
driver = webdriver.Chrome()

# Navigate to Amazon.com
driver.get("https://www.amazon.com/")

# Show an alert message when the website is opened
alert = Alert(driver)
alert_text = "Amazon website opened successfully!"
driver.execute_script(f"alert('{alert_text}');")

# Wait for a few seconds to see the alert
time.sleep(5)

# Accept the alert
alert.accept()

# Print a message indicating the action taken
print("Navigated to the first product page.")

# Close the WebDriver session
driver.quit()
        </code></pre>
            </div>
        </div>

        <div class="project" id="practical3"> 
            <h2>Practical 3:Refreshing WebPagewhile Automation Testing With Selenium Webdriver.</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
import time

# Set up the WebDriver (e.g., Chrome)
driver = webdriver.Chrome()

# Open a webpage
driver.get('https://www.w3schools.com/')

# Wait for the page to load completely
time.sleep(3)

# Refresh the webpage
driver.refresh()

# Alternatively, you can use JavaScript to refresh the page
driver.execute_script("location.reload()")

# Wait for the page to load completely after refresh
time.sleep(3)

# Close the browser
driver.quit()
        </code></pre>
            </div>
        </div>

        <div class="project" id="practical4">
            <h2>Practical 4:Working with different Web Browsers using Selenium Webdriver.</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
from selenium import webdriver

# Open Firefox browser
driver = webdriver.Firefox()
driver.get("https://www.javatpoint.com/")

# Open Chrome browser
chrome_options = webdriver.ChromeOptions()
driver = webdriver.Chrome()
driver.get("https://www.javatpoint.com/")

# Open Safari browser (on MacOS)
driver = webdriver.Edge()
driver.get("https://www.javatpoint.com/")

# Close the browser
driver.quit()
        </code></pre>
            </div>
        </div>

        <div class="project" id="practical5">
            <h2>Practical 5:Handling following controls and events using Selenium Web driver. Controls: Drop down, File upload, Alert and PopUps,
                multiple windows. Mouse Events: Mouse Hover , Mouse Right click, Mouse Double Click and Drag and Drop.</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
from selenium import webdriver
from selenium.webdriver.support.ui import Select
import time

# Initialize the WebDriver
driver = webdriver.Chrome()

# Handling Drop-down
def handle_dropdown():
    try:
        # Open the target web page
        driver.get('https://www.amazon.in/Yakuza-Blue-Electric-Scooty-Lead/dp/B0CNRYQ9BK')
        dropdown = Select(driver.find_element('id', 'searchDropdownBox'))
        dropdown.select_by_visible_text('Gift Cards')  # Change 'Gift Cards' to the actual text of the dropdown option
        print("Dropdown handled successfully.")
    except Exception as e:
        print(f"Error handling dropdown: {e}")

# Handling File Upload
def handle_file_upload():
    try:
        driver.get('https://www.w3schools.com/howto/howto_html_file_upload_button.asp')
        file_input = driver.find_element('id', 'myFile')
        file_input.send_keys('report.md')  # Change to your file path
        # Optionally click the submit button if needed
        # driver.find_element('xpath', '//input[@type="submit"]').click()
        print("File upload handled successfully.")
    except Exception as e:
        print(f"Error handling file upload: {e}")

# Handling Alerts
def handle_alert():
    try:
        driver.get('https://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_alert')
        driver.switch_to.frame("iframeResult")
        driver.find_element('xpath', '//button[contains(text(),"Try it")]').click()
        alert = driver.switch_to.alert
        time.sleep(3)
        alert.accept()
        driver.switch_to.default_content()
        print("Alert handled successfully.")
    except Exception as e:
        print(f"Error handling alert: {e}")

# Handling Pop-ups
def handle_popups():
    try:
        driver.get('https://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_win_open')
        driver.switch_to.frame("iframeResult")
        driver.find_element('xpath', '//button[contains(text(),"Try it")]').click()
        main_window = driver.current_window_handle
        all_windows = driver.window_handles
        for window in all_windows:
            if window != main_window:
                driver.switch_to.window(window)
                break
        # Perform actions in the new window
        time.sleep(5)  # Just to keep the new window open for a while
        driver.close()
        driver.switch_to.window(main_window)
        print("Pop-up handled successfully.")
    except Exception as e:
        print(f"Error handling popups: {e}")

# Run the handlers one by one
handle_dropdown()
time.sleep(5)  # Pause to see the result

handle_file_upload()
time.sleep(5)  # Pause to see the result

handle_alert()
time.sleep(5)  # Pause to see the result

handle_popups()
time.sleep(5)  # Pause to see the result

# Close the browser
driver.quit()
        </code></pre>
            </div>
        </div>

        <div class="project" id="practical6">
            <h2>Practical 6:Working with implicit Wait, Explicit Wait and Fluent Wait using Selenium.</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import NoSuchElementException

def implicit_wait_example(driver):
    # Set implicit wait time
    driver.implicitly_wait(10)
    driver.get("https://www.google.com")
    print("Current URL (Implicit Wait):", driver.current_url)
    try:
        element = driver.find_element(By.NAME, "q")  # Google's search box (name="q")
        print("Element found using implicit wait")
    except NoSuchElementException:
        print("Element not found using implicit wait")

def explicit_wait_example(driver):
    driver.get("https://www.google.com")
    print("Current URL (Explicit Wait):", driver.current_url)
    try:
        # Set explicit wait time
        element = WebDriverWait(driver, 10).until(
            EC.presence_of_element_located((By.LINK_TEXT, "Gmail")) 
        )
        print("Element found using explicit wait")
    except Exception as e:
        print("Element not found using explicit wait:", e)

def fluent_wait_example(driver):
    driver.get("https://www.google.com")
    print("Current URL (Fluent Wait):", driver.current_url)
    try:
        # Set fluent wait time with polling interval and ignoring NoSuchElementException
        fluent_wait = WebDriverWait(driver, 10, poll_frequency=1, ignored_exceptions=[NoSuchElementException])
        element = fluent_wait.until(
            EC.presence_of_element_located((By.LINK_TEXT, "Images"))
        )
        print("Element found using fluent wait")
    except Exception as e:
        print("Element not found using fluent wait:", e)

if __name__ == "__main__":  # Corrected typo
    # Set up the driver 
    driver = webdriver.Chrome()

    # Run examples
    implicit_wait_example(driver)
    explicit_wait_example(driver)
    fluent_wait_example(driver)

    # Quit the driver
    driver.quit()
        </code></pre>
            </div>
        </div>

                <div class="project" id="practical7">
            <h2>Practical 7:Capturing Partial Screenshots using Selenium.</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
from selenium import webdriver
from selenium.webdriver.common.by import By
from PIL import Image
import io

def capture_partial_screenshot(driver, element, save_path):
    # Capture the full page screenshot as PNG
    screenshot = driver.get_screenshot_as_png()
    
    # Convert the screenshot to a PIL Image
    screenshot_image = Image.open(io.BytesIO(screenshot))
    
    # Get the element's location and size
    location = element.location
    size = element.size
    
    # Define the bounding box for the element
    left = location['x']
    top = location['y']
    right = left + size['width']
    bottom = top + size['height']
    
    # Crop the screenshot to the bounding box of the element
    element_screenshot = screenshot_image.crop((left, top, right, bottom))
    
    # Save the cropped screenshot
    element_screenshot.save(save_path)
    print(f"Partial screenshot saved at {save_path}")

if _name_ == "_main_":
    # Setup the driver (ensure you have the correct path to your Chromedriver)
    driver = webdriver.Chrome()
    
    # Navigate to the desired URL
    driver.get("http://www.google.com")
    
    # Locate the element (e.g., Google's search box)
    element = driver.find_element(By.NAME, "q")
    
    # Capture and save the partial screenshot
    capture_partial_screenshot(driver, element, "partial_screenshot.png")
    
    # Quit the Driver
    driver.quit()
        </code></pre>
            </div>
        </div>

        <div class="project" id="practical8">
            <h2>Practical 8:Automate low-level interactions for automation testing using ActionChains() method.</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import TimeoutException, NoSuchElementException
import time

# Setup the WebDriver (Chrome in this example)
options = webdriver.ChromeOptions()
options.add_experimental_option("detach", True)
driver = webdriver.Chrome(options=options)

try:
    # Navigate to the website
    print("Navigating to the website...")
    driver.get("https://the-internet.herokuapp.com")
    print("Page loaded.")

    # Wait for the page to load
    WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.TAG_NAME, "body")))

    # Initialize ActionChains
    actions = ActionChains(driver)

    # Example 1: Hover over an element
    print("Attempting to hover over an element...")
    try:
        driver.get("https://the-internet.herokuapp.com/hovers")
        hover_element = WebDriverWait(driver, 10).until(
            EC.presence_of_element_located((By.CLASS_NAME, "figure"))
        )
        actions.move_to_element(hover_element).perform()
        print("Hover action completed.")
    except TimeoutException:
        print("Hover element not found within timeout period.")
    except Exception as e:
        print(f"An error occurred during hover action: {e}")

    # Example 2: Drag and Drop
    print("Attempting drag and drop...")
    try:
        driver.get("https://the-internet.herokuapp.com/drag_and_drop")
        source = WebDriverWait(driver, 10).until(
            EC.presence_of_element_located((By.ID, "column-a"))
        )
        target = WebDriverWait(driver, 10).until(
            EC.presence_of_element_located((By.ID, "column-b"))
        )
        actions.drag_and_drop(source, target).perform()
        print("Drag and drop completed.")
    except TimeoutException:
        print("Drag and drop elements not found within timeout period.")
    except Exception as e:
        print(f"An error occurred during drag and drop: {e}")

    # Example 3: Key Actions
    print("Attempting key actions...")
    try:
        driver.get("https://the-internet.herokuapp.com/key_presses")
        input_element = WebDriverWait(driver, 10).until(
            EC.presence_of_element_located((By.ID, "target"))
        )
        actions.click(input_element).send_keys("Hello").perform()
        actions.key_down(Keys.SHIFT).send_keys(" world").key_up(Keys.SHIFT).perform()
        print("Key actions completed.")
    except TimeoutException:
        print("Input element not found within timeout period.")
    except Exception as e:
        print(f"An error occurred during key actions: {e}")

    # Example 4: Context Click (Right Click)
    print("Attempting context click...")
    try:
        driver.get("https://the-internet.herokuapp.com/context_menu")
        context_element = WebDriverWait(driver, 10).until(
            EC.presence_of_element_located((By.ID, "hot-spot"))
        )
        actions.context_click(context_element).perform()
        print("Context click completed.")
        # Handle the alert
        alert = WebDriverWait(driver, 3).until(EC.alert_is_present())
        alert.accept()
    except TimeoutException:
        print("Context menu element not found within timeout period.")
    except Exception as e:
        print(f"An error occurred during context click: {e}")

    print("All actions attempted. The browser will remain open for 30 seconds.")
    time.sleep(30)

except Exception as e:
    print(f"An unexpected error occurred: {e}")

finally:
    print("Closing the browser...")
    driver.quit()
        </code></pre>
            </div>
        </div>

        <div class="project" id="practical9">
            <h2>Practical 9:Open A Webpage In A New Tab With Selenium Webdriver.</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import TimeoutException

def open_new_tab(driver, url):
    # Open a new tab
    driver.execute_script("window.open('');")
    
    # Switch to the new tab (it's the last one in the list)
    driver.switch_to.window(driver.window_handles[-1])
    
    # Navigate to the specified URL
    driver.get(url)

# Setup the WebDriver (Chrome in this example)
driver = webdriver.Chrome()

try:
    # Navigate to an initial page
    initial_url = "https://www.example.com"
    driver.get(initial_url)
    print(f"Opened initial page: {initial_url}")

    # Open a new tab and navigate to a different page
    new_url = "https://www.python.org"
    open_new_tab(driver, new_url)
    print(f"Opened new tab with: {new_url}")

    # Wait for an element on the new page to ensure it's loaded
    try:
        element = WebDriverWait(driver, 10).until(
            EC.presence_of_element_located((By.ID, "submit"))
        )
        print("New page loaded successfully")
    except TimeoutException:
        print("Timed out waiting for page to load")

    # Demonstrate switching back to the original tab
    driver.switch_to.window(driver.window_handles[0])
    print(f"Switched back to the original tab: {driver.current_url}")

    # Wait for user input before closing
    input("Press Enter to close the browser...")

except Exception as e:
    print(f"An error occurred: {e}")

finally:
    # Close the browser
    driver.quit()
    print("Browser closed")
        </code></pre>
            </div>
        </div>

        <div class="project" id="practical10">
            <h2>Practical 10:Extracting Results Of JavaScript Code With Selenium Webdriver.</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

# Set up the WebDriver (this example uses Chrome)
driver = webdriver.Chrome()

# Navigate to Wikipedia
driver.get("https://www.wikipedia.org")

# Find the search input field and enter a search term
search_input = driver.find_element(By.ID, "searchInput")
search_input.send_keys("Python programming")
search_input.send_keys(Keys.RETURN)

# Wait for the search results page to load
WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.ID, "firstHeading")))

# Extract the page title using JavaScript
page_title = driver.execute_script("return document.title;")
print(f"Page title: {page_title}")

# Extract the first paragraph of the article using JavaScript
first_paragraph = driver.execute_script("""
    var paragraphs = document.getElementsByTagName('p');
    for (var i = 0; i < paragraphs.length; i++) {
        if (paragraphs[i].textContent.trim().length > 0) {
            return paragraphs[i].textContent.trim();
        }
    }
    return '';
""")
print(f"First paragraph: {first_paragraph}")

# Get all external links in the article
external_links = driver.execute_script("""
    var links = document.querySelectorAll('a.external');
    return Array.from(links).map(link => link.href);
""")
print("External links:")
for link in external_links[:5]:  # Print first 5 links
    print(link)

# Close the browser
driver.quit()
        </code></pre>
            </div>
        </div>

        <div class="project" id="practical11">
            <h2>Practical 11:Reading data from Excel file and Writing data in Excel file using Selenium.</h2>
            <p>A brief description of your project.</p>
            <div class="code-container">
                <button class="copy-button">Copy</button>
                <pre><code class="language-python">
import pandas as pd
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

def read_excel(file_path):
    return pd.read_excel(file_path)

def write_excel(data, file_path):
    df = pd.DataFrame(data)
    df.to_excel(file_path, index=False)

def search_wikipedia(driver, term):
    driver.get("https://www.wikipedia.org")
    search_input = driver.find_element(By.ID, "searchInput")
    search_input.clear()
    search_input.send_keys(term)
    search_input.send_keys(Keys.RETURN)
    
    WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.ID, "firstHeading")))
    
    first_paragraph = driver.execute_script("""
        var paragraphs = document.getElementsByTagName('p');
        for (var i = 0; i < paragraphs.length; i++) {
            if (paragraphs[i].textContent.trim().length > 0) {
                return paragraphs[i].textContent.trim();
            }
        }
        return '';
    """)
    
    return first_paragraph

def main():
    # Read search terms from Excel
    input_df = read_excel("input_search_terms.xlsx")
    search_terms = input_df["SearchTerms"].tolist()

    # Set up Selenium WebDriver
    driver = webdriver.Chrome()

    results = []
    
    # Process each search term
    for term in search_terms:
        result = search_wikipedia(driver, term)
        results.append({"SearchTerm": term, "FirstParagraph": result})

    # Close the browser
    driver.quit()

    # Write results to a new Excel file
    write_excel(results, "output_results.xlsx")

    print("Search completed. Results written to output_results.xlsx")

if _name_ == "_main_":
    main()
        </code></pre>
            </div>
        </div>

    </div>

    <button id="backToTop" onclick="scrollToTop()">Back to Top</button>
    <script src="script.js"></script>
</body>

</html>
